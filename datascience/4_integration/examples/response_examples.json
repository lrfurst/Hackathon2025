# Response Examples (Contrato Real)

> Documento **tÃ©cnico e defensivo**. Tudo aqui Ã© **o que o cliente Java pode assumir**.  
> O que nÃ£o estÃ¡ aqui **nÃ£o faz parte do contrato**.

---

## PrincÃ­pios

- âŒ Nenhuma promessa de SLA, P95, acurÃ¡cia ou impacto financeiro
- âŒ Nenhum campo de negÃ³cio, mÃ©trica, confianÃ§a ou custo
- âŒ Nenhum header garantido alÃ©m de `Content-Type`
- âœ… Resposta mÃ­nima, estÃ¡vel e previsÃ­vel
- âœ… Erros explÃ­citos â†’ responsabilidade do cliente

---

## Resposta de Sucesso (HTTP 200)

### Formato **Ãºnico** aceito

```json
{
  "prediction": {
    "atraso": true,
    "probabilidade": 0.0
  }
}
```

### Regras

- `atraso`: boolean
- `probabilidade`: nÃºmero entre **0.0 e 1.0**
- Nenhum outro campo Ã© garantido

### Exemplos vÃ¡lidos

#### Atraso provÃ¡vel
```json
{
  "prediction": {
    "atraso": true,
    "probabilidade": 0.87
  }
}
```

#### Sem atraso provÃ¡vel
```json
{
  "prediction": {
    "atraso": false,
    "probabilidade": 0.32
  }
}
```

---

## Respostas de Erro

### 422 â€” Erro de validaÃ§Ã£o

Formato **compatÃ­vel com FastAPI / Pydantic**.

```json
{
  "detail": [
    {
      "loc": ["body", "data_hora_partida"],
      "msg": "Formato de data invÃ¡lido",
      "type": "value_error"
    }
  ]
}
```

ğŸ“Œ **AÃ§Ã£o do cliente**: corrigir payload. **NÃ£o retentar automaticamente**.

---

### 400 â€” JSON malformado

```json
{
  "detail": "JSON invÃ¡lido"
}
```

ğŸ“Œ **AÃ§Ã£o do cliente**: corrigir serializaÃ§Ã£o.

---

### 5xx â€” Erro interno

```json
{
  "detail": "Erro interno"
}
```

ğŸ“Œ **AÃ§Ã£o do cliente**:
- Retry com backoff **permitido**
- Fallback **permitido**

---

## O que foi removido (intencionalmente)

- `status`, `metadata`, `business_metrics`
- `model_version`, `processing_time_ms`, `request_id`, `trace_id`
- `/health`, `/metrics`
- Rate limit, retry-after, headers customizados
- Qualquer interpretaÃ§Ã£o de negÃ³cio

> Esses elementos **nÃ£o sÃ£o contrato de integraÃ§Ã£o**.

---

## Guia mÃ­nimo para Java

### Regras de ouro

- Timeout Java â‰¥ **3000ms**
- 4xx â†’ erro de payload (nÃ£o retry)
- 5xx / timeout â†’ retry + fallback
- Nunca inferir nada alÃ©m de `prediction`

### Exemplo defensivo

```java
if (response != null && response.getPrediction() != null) {
    boolean atraso = response.getPrediction().isAtraso();
    double prob = response.getPrediction().getProbabilidade();
}
```

---

## Regra final

> Se a API mudar, **este arquivo muda junto**.  
> Se nÃ£o estiver documentado aqui, **o Java nÃ£o deve usar**.